Metadata-Version: 2.4
Name: bsaseq
Version: 0.1.0
Summary: Bulk Segregant Analysis of pooled whole-genome sequencing data
Author: BSAseq Authors
License: MIT
Project-URL: Homepage, https://github.com/bsaseq/bsaseq
Project-URL: Documentation, https://github.com/bsaseq/bsaseq
Project-URL: Repository, https://github.com/bsaseq/bsaseq
Keywords: bioinformatics,genomics,BSA,QTL,bulk-segregant-analysis
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Science/Research
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Classifier: Topic :: Scientific/Engineering :: Bio-Informatics
Requires-Python: <3.14,>=3.9
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: cyvcf2>=0.30.0
Requires-Dist: numpy>=1.21.0
Requires-Dist: pandas>=1.4.0
Requires-Dist: scipy>=1.7.0
Requires-Dist: click>=8.0.0
Requires-Dist: rich>=12.0.0
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov; extra == "dev"
Dynamic: license-file

# bsaseq

Bulk Segregant Analysis (BSA) of pooled whole-genome sequencing data for QTL mapping.

## Overview

`bsaseq` is a command-line tool for mapping causal mutations by comparing allele frequencies between mutant and wild-type pooled DNA samples. It is designed for plant geneticists performing bulk segregant analysis with next-generation sequencing data.

## Installation

```bash
# From source
git clone https://github.com/bsaseq/bsaseq.git
cd bsaseq
pip install -e .

# With development dependencies
pip install -e ".[dev]"
```

## Requirements

- Python 3.9-3.12
- cyvcf2 >= 0.30.0
- numpy >= 1.21.0
- pandas >= 1.4.0
- click >= 8.0.0
- rich >= 12.0.0

## Quick Start

### List samples in a VCF file

```bash
bsaseq samples --vcf your_variants.vcf.gz
```

### Run BSA analysis

```bash
bsaseq run \
    --vcf your_variants.vcf.gz \
    --high-bulk MUTANT_POOL \
    --low-bulk WILDTYPE_POOL \
    --out results/analysis
```

## Input Format

The tool expects a VCF file containing:
- Biallelic SNPs from two pooled samples
- AD (allelic depth) field in the FORMAT column
- GQ (genotype quality) field for filtering

## Command Reference

### `bsaseq samples`

List all sample names in a VCF file. Useful for identifying correct sample names before analysis.

```bash
bsaseq samples --vcf input.vcf.gz
```

### `bsaseq run`

Run the complete BSA analysis pipeline.

Options:
- `--vcf`: Input VCF file (required)
- `--high-bulk`: Sample name for high/mutant bulk (required)
- `--low-bulk`: Sample name for low/wild-type bulk (required)
- `--out`, `-o`: Output prefix (required)
- `--min-dp`: Minimum read depth per sample (default: 10)
- `--max-dp`: Maximum read depth per sample (default: 200)
- `--min-gq`: Minimum genotype quality (default: 20)
- `--min-qual`: Minimum variant QUAL score (default: 30.0)

## Output

The analysis produces:
- Per-variant allele frequency differences (delta-AF)
- Summary statistics of filtering steps
- (Future: windowed analysis results, plots)

## Development

```bash
# Install with dev dependencies
pip install -e ".[dev]"

# Run tests
pytest tests/ -v

# Run with coverage
pytest tests/ --cov=bsaseq --cov-report=html
```

## License

MIT License - see [LICENSE](LICENSE) for details.

## Citation

If you use bsaseq in your research, please cite:
> bsaseq: A tool for Bulk Segregant Analysis of pooled sequencing data (in preparation)
